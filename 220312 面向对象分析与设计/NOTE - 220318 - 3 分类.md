

# 分类

分类是组织知识的手段

> 在`面向对象设计`中，认识到事务间的相似性让我们能够将`共性`放在关键抽象和机制中，最终导致更小的应用和更简单的架构

> 没有所谓的“完美”类结构，也没有一组“正确”的对象。像所有工程学科一样，我们的设计选择是对许多竞争因素的折中。



## 分类的重要性

确定类和对象是`面向对象分析和设计`过程中具有挑战性的部分。经验表明，这种确定过程既涉及发现，也涉及发明。

> 通过发现，我们逐渐从问题域的词汇表中识别出`关键抽象`和`机制`
>
> 通过发明，我们设计出泛化的抽象和一些新的机制。规定对象协作的方式。
>
> 归根到底，发现和发明都是`分类`问题，而`分类`基本上是发现`共性`的问题
>
> 当进行分类时，我们寻找具有共同结构或表现除共同行为的一组事物



## 分类的困难

> 即使在十分严格的科学学科中，分类的结果在很大程度上也取决于进行分类的原因



## 分类的增量和迭代本质

在软件工程中，“单个抽象的形成常常遵循某个常见的模式。

首先，问题以一种随意的方式得到解决。

随着经验的积累，人们发现某些解决方式比另外一些解决方式效果更好，一些好方法在人们之间口口相传。

最后，有用的解决方案得到了更系统的理解，人们对它们进行编码和分析。

这使得人们能够形成支持自动化实现的模型，以及让这个解决方案更通用的理论。

这反过来又导致了更复杂层次的实践，让我们能处理更复杂的问题。

我们对这些问题同通常还是采取随意的方式。

于是，这个循环又开始了。

> 明智的分类是很艰难的智力工作，最好是通过一个`增量式`、`迭代式`的过程来完成



> 在设计复杂软件系统时，分类的增量式、迭代式本质直接影响了类和对象的层次结构





## 确定类和对象

### 经典方法和现代方法

#### 经典分类

> 所有具有某一个或某一组共同属性的实体构成了一个分类。这样的属性对于定义这个分类是必要的，也是充分的。 

> 根据我们对事物所具有的属性和效用等本质的知识，我们可以对它进行命名

> 经典分类法利用相关的属性作为对象间相似性的判据。

> 最有用的属性集合是其成员没有太多相互影响的集合。
>
> 一般来说，属性可以不只表示可以测量的特征，也可以包含观察到的行为

**对于任何自然的分类来说，在实践中似乎不可能得到一个属性列表，能够排除所有不在这个分类中的个例并包含所有在这个分类中的个例**。这是`分类中的基本问题`，概念聚集和原型理论试图解决这个问题。



#### 概念聚集

> 在这种方法中，类（一些实体的聚集）的产生首先形成类的概念描述，然后再根据这些描述对实体进行分类

> 概念聚集与模糊（多值）集理论是有密切关系的，在这种理论中，对象可以按不同的适合程度属于一个或多个分组。
>
> 概念聚集通过关注“最适合”来进行绝对的分类判断



#### 原型理论

> 对象的类是由一个原型对象来代表的，如果一个对象与这个原型表现出重要的相似性，那么这个对象就被认为是这个类的一员。



### 面向对象分析

##### 经典方法

> 经典方法关注问题领域中实实在在的事物

通常的来源

* 实物：汽车、遥测数据、压力传感器
* 角色：母亲、教师、政治家
* 事件：着陆、中断、请求
* 交互：借贷、会议、相交

数据库建模的角度

* 人：执行某项功能的人
* 地点：人或物相关的区域
* 物：实实在在的物理对象或对象的分组
* 组织：正式组织起来的人、资源、机制和功能的集合，具有确定的任务，它的存在基本上与个人无关
* 概念：不可触摸的原则或思想，用于组织或跟踪业务活动和沟通
* 事件：发生的事情，通常是在某个日期和事件针对另外的事物发生的，或者是一个序列中的步骤

可能对象的来源

* 结构：“is a” 和“part of”关系
* 其他系统：与应用进行交互的外部系统
* 设备：与应用进行交互的设备
* 要记住的事件：必须记录的历史事件
* 扮演的角色：用户在应用的交互中扮演的不同角色
* 位置：对应用来说有重要意义的物理位置、办公室和地点
* 组织结构单位：用户属于的群体

#### 行为分析

> 行为分析：关注动态的行为，将这些行为作为类和对象的主要来源

职责

>职责代表的是“对象维护的知识和可以执行的动作，其意义在于表达一个对象的目的以及它在系统中的位置
>
>对象的职责是针对它支持的所有契约而提供的全部服务
>
>在这种方式中，我们将具有共同职责的事物划分为一组，让超类包含一般的职责，让子类包含特殊的行为，从而构成类的层次结构

系统的功能

> 功能点作为最终用户的一项业务功能而定义的
>
> 功能点嗲表了某种输出、查询、输入、文件或接口
>
> 功能点是系统外部可见的、可测试的行为

#### 领域分析

> 确定对象、操作和关系的尝试，领域专家认为这些对象、操作和关系对这个领域很重要

领域分析的步骤

* 咨询领域专家，构建一个通用的模型草稿
* 检查领域中原有的系统，以一种通用的格式展示出这方面的理解
* 咨询领域专家，确定系统间的相似和差异
* 细化通用模型，以包含原有的系统

谁才是领域专家

* 用户，实际领域从事人员，熟悉该领域的某个问题的方方面面
* 通常不会是一名软件开发者

#### 用例分析

> 用例的定义：一个执行者通过与系统进行对话的方式执行一个行为上相关的事务序列，目的是为执行者提供某种可度量的价值

可以在需求分析时，就应用用例分析，此时，最终用户、其他领域专家和开发团队列出系统操作的基本场景（不需要一开始就细化这些场景，只要列出它们就行了）



#### CRC卡

> CRC卡就是一种索引卡片，分析师在上面用铅笔写下类的名称（卡顶部）、它的职责（卡的一半）以及它的协作者（卡的另一半）

CRC卡可以摆放在不同的位置，以代表协作的模式。

从场景的动态语义上来看，卡片可以按一定顺序拜访，展示每个类的原型实例之间的消息流。

从场景的静态语义来看，卡片可以按一定顺序拜访，展示类之间的泛化/特化或聚合层次结构





## 关键抽象和机制

> 关键抽象是一个类或对象，它是问题域词汇表的一部分
>
> 机制 描述对象协作的结构，这些对象协作结构提供了某种行为，满足了问题的一项需求。一个类的设计包含了单个对象如何行为的知识，而一种机制则是关于一组对象如何协作的设计决策
>
> 机制代表了行为的模式





关键抽象的命名的建议

* 对象应该用合适的名词词组来命名
* 类应该用常见的名词词组来命名
* 如果可能，选择的名称应该是领域专家使用和认识的名称
  修改操作应该用一个主动语态的动词词组来命名
* 选择操作应该表示出查询的意思，或者用be动词的形式来命名
* 使用下划线和大写字母主要是个人的喜好，但不论采用哪种风格，至少在程序内要保持一致

## 